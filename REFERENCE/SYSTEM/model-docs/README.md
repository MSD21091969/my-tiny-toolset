# Model Documentation Index

# Model Documentation

**Last updated:** 2025-10-17  
**Documentation Status:** 121 models documented (all Pydantic models in codebase)  
**Source:** Auto-generated by `TOOLSET/documentation-tools/model_docs_generator.py`  
**Index:** See [index.md](./index.md) for complete model catalog by package

---

## Purpose

This directory contains **auto-generated documentation for all 121 Pydantic models** in the my-tiny-data-collider application. This is the single source of truth for model documentation, replacing manual YAML inventories.

**28 registered service methods** use these models as their data contracts, exposing them through **34 tool YAMLs** to agents.

### The Method → Model → Tool Chain

```
28 Service Methods (@register_service_method)
    ↓ use
37 Core Models (Request/Response DTOs + Domain Entities)
    ↓ wrapped by
34 Tool YAMLs (config/methodtools_v1/)
    ↓ consumed by
Agents (tool_calls → backend execution)
```

**Key Insight:** The 37 documented models are the **data contracts** for the 28 methods that tools expose to agents.

### Documentation Coverage

**All 121 models are now documented** across packages:
- `pydantic_models.base` - Base envelopes and types
- `pydantic_models.canonical` - 9 core domain entities
- `pydantic_models.operations` - Request/Response/Payload models for all 28 methods
- `pydantic_models.views` - Summary and list view models
- `pydantic_models.workspace` - Google Workspace data models

**Service Method Breakdown (28 total):**
- CasefileService: 13 methods (CRUD, ACL, workspace sync)
- ToolSessionService: 5 methods (session lifecycle, tool execution)
- CommunicationService: 5 methods (chat sessions, message processing)
- RequestHub: 3 methods (composite operations)
- Google Workspace Clients: 6 methods (Gmail, Drive, Sheets)

**Regeneration:**
```powershell
cd C:\Users\HP\my-tiny-toolset\TOOLSET\documentation-tools
$env:COLLIDER_PATH = "C:\Users\HP\my-tiny-data-collider"
python model_docs_generator.py --generate-all --output ..\..\REFERENCE\SYSTEM\model-docs\
```

---

## Model Organization by Architecture Layer

### 1. Domain Entities (`canonical/`) - 9 models

**Purpose:** Core business objects with domain logic

| Model | Purpose | Key Features |
|-------|---------|--------------|
| [CasefileModel](./CasefileModel.md) | Complete casefile with all data | Workspace sync, ACL, session linking |
| [CasefileMetadata](./CasefileMetadata.md) | Casefile metadata | Title, description, tags, timestamps |
| [CasefileACL](./CasefileACL.md) | Access control list | Owner, permissions, public access |
| [PermissionEntry](./PermissionEntry.md) | Single permission entry | User, level, expiration |
| [ResourceReference](./ResourceReference.md) | External resource link | Resource ID, type, metadata |
| [ToolSession](./ToolSession.md) | Tool execution session | Request tracking, events, audit |
| [ToolEvent](./ToolEvent.md) | Single tool event | Tool name, parameters, result, chain |
| [AuthToken](./AuthToken.md) | Authentication token | User, session, casefile context |
| [ChatSession](./ChatSession.md) | Chat conversation session | Messages, events, history |

---

### 2. Request/Response DTOs (`operations/`) - 12 documented

**Purpose:** Operation-specific request and response models following RAR pattern

#### Casefile Operations
| Operation | Request | Response |
|-----------|---------|----------|
| Create | [CreateCasefileRequest](./CreateCasefileRequest.md) | [CreateCasefileResponse](./CreateCasefileResponse.md) |
| Read | [GetCasefileRequest](./GetCasefileRequest.md) | [GetCasefileResponse](./GetCasefileResponse.md) |
| Update | [UpdateCasefileRequest](./UpdateCasefileRequest.md) | [UpdateCasefileResponse](./UpdateCasefileResponse.md) |
| Delete | [DeleteCasefileRequest](./DeleteCasefileRequest.md) | [DeleteCasefileResponse](./DeleteCasefileResponse.md) |
| List | [ListCasefilesRequest](./ListCasefilesRequest.md) | [ListCasefilesResponse](./ListCasefilesResponse.md) |

**Payloads:**
- [CreateCasefilePayload](./CreateCasefilePayload.md) - Input data for creation
- [UpdateCasefilePayload](./UpdateCasefilePayload.md) - Fields to update

**Pattern:** All operations follow `BaseRequest[PayloadT]` → Service → `BaseResponse[PayloadT]` pattern

---

### 3. View Models (`views/`) - 3 models

**Purpose:** Optimized summary views for list operations and API responses

| Model | Purpose | Used In |
|-------|---------|---------|
| [CasefileSummary](./CasefileSummary.md) | Lightweight casefile summary | List casefiles response |
| [SessionSummary](./SessionSummary.md) | Tool session summary | List sessions response |
| [ChatSessionSummary](./ChatSessionSummary.md) | Chat session summary | List chat sessions response |

**Pattern:** Views contain subset of full model fields optimized for listing/pagination

---

### 4. Google Workspace Models (`workspace/`) - 13 models

**Purpose:** Typed representations of Google Workspace data (Gmail, Drive, Sheets)

#### Gmail Models (5)
| Model | Purpose |
|-------|---------|
| [GmailMessage](./GmailMessage.md) | Complete email message with metadata |
| [GmailAttachment](./GmailAttachment.md) | Email attachment metadata |
| [GmailThread](./GmailThread.md) | Email thread grouping |
| [GmailLabel](./GmailLabel.md) | Gmail label/folder |
| [CasefileGmailData](./CasefileGmailData.md) | All Gmail data for a casefile |

#### Google Drive Models (4)
| Model | Purpose |
|-------|---------|
| [DriveFile](./DriveFile.md) | Google Drive file metadata |
| [DriveFolder](./DriveFolder.md) | Google Drive folder |
| [DriveOwner](./DriveOwner.md) | File/folder owner |
| [CasefileDriveData](./CasefileDriveData.md) | All Drive data for a casefile |

#### Google Sheets Models (4)
| Model | Purpose |
|-------|---------|
| [SheetData](./SheetData.md) | Complete spreadsheet data |
| [SheetMetadata](./SheetMetadata.md) | Sheet tab metadata |
| [SheetRange](./SheetRange.md) | Cell range with values |
| [CasefileSheetsData](./CasefileSheetsData.md) | All Sheets data for a casefile |

---

## Model Hierarchy

```
CasefileModel (root entity)
├── metadata: CasefileMetadata
├── acl: CasefileACL
│   ├── permissions: List[PermissionEntry]
│   └── public_access: PermissionLevel
├── resources: Dict[str, List[ResourceReference]]  # deprecated
├── session_ids: List[str]  # links to ToolSession/ChatSession
├── gmail_data: CasefileGmailData
│   ├── messages: List[GmailMessage]
│   │   └── attachments: List[GmailAttachment]
│   ├── threads: List[GmailThread]
│   └── labels: List[GmailLabel]
├── drive_data: CasefileDriveData
│   ├── files: List[DriveFile]
│   │   └── owners: List[DriveOwner]
│   └── folders: List[DriveFolder]
└── sheets_data: CasefileSheetsData
    └── spreadsheets: Dict[str, SheetData]
        ├── metadata: List[SheetMetadata]
        └── ranges: List[SheetRange]

ToolSession (execution audit)
├── tool_events: List[ToolEvent]
└── auth_tokens: List[AuthToken]

ChatSession (conversation)
├── messages: List[Dict]
└── events: List[Dict]
```

---

## Model Statistics: Methods → Models → Tools

| Service | Methods | Models Used | Tool YAMLs Generated |
|---------|---------|-------------|---------------------|
| CasefileService | 13 | 12 operations + 9 canonical + 13 workspace | 13 tools |
| ToolSessionService | 5 | 8 tool_session_ops + 3 canonical | 5 tools |
| CommunicationService | 5 | 8 chat_session_ops + 1 canonical | 5 tools |
| RequestHub | 3 | 4 request_hub_ops + composite | 3 tools |
| Google Workspace | 6 | 13 workspace models | 6 tools |
| **Total** | **28** | **37 core models** | **34 tools** |

**Model Distribution by Package:**

| Package | Models Documented | Purpose | Used By |
|---------|-------------------|---------|---------|
| `canonical/` | 9 | Core domain entities | All services (shared) |
| `operations/` | 12 | Request/Response DTOs (subset) | Method signatures |
| `views/` | 3 | Summary views for lists | List operations |
| `workspace/` | 13 | Google Workspace data | Casefile + Workspace methods |
| **Total** | **37** | **Public API surface** | **28 methods → 34 tools** |

**Full Codebase (78 total models):**
- `operations/` - 52 models (includes all 28 method Request/Response pairs + payloads)
- `workspace/` - 13 models (documented)
- `canonical/` - 9 models (documented)
- `views/` - 3 models (documented)
- `base/` - 1 model (RequestEnvelope infrastructure)

---

## Quick Reference by Use Case

### Creating a Casefile
1. Build [CreateCasefilePayload](./CreateCasefilePayload.md) with title, description, tags
2. Wrap in [CreateCasefileRequest](./CreateCasefileRequest.md)
3. Service returns [CreateCasefileResponse](./CreateCasefileResponse.md) with casefile_id

### Storing Gmail Data
1. Fetch messages from Gmail API
2. Convert to [GmailMessage](./GmailMessage.md) models
3. Store via `store_gmail_messages` method
4. Data persisted in [CasefileGmailData](./CasefileGmailData.md)

### Managing Permissions
1. Get [CasefileACL](./CasefileACL.md) from casefile
2. Add [PermissionEntry](./PermissionEntry.md) for user
3. Use `grant_permission` method to apply

### Tool Execution Audit
1. Create [ToolSession](./ToolSession.md) via `create_session`
2. Each tool call creates [ToolEvent](./ToolEvent.md)
3. Events linked via `chain_id` for workflows
4. Query via `get_session` for audit trail

---

## Validation Framework

All models use:
- **30 custom types** from `pydantic_models.base.custom_types` (CasefileId, IsoTimestamp, ShortString, etc.)
- **12 reusable validators** from `pydantic_models.base.validators` (timestamp_order, list_unique, conditional_required)
- Full guide: `../../SUBJECTS/shared-patterns/validation-patterns.md`

---

## Generation & Updates

**Generator:** `$env:MY_TOOLSET\documentation-tools\model_docs_generator.py`

**Regenerate all docs:**
```powershell
cd C:\Users\HP\my-tiny-data-collider
python $env:MY_TOOLSET\documentation-tools\model_docs_generator.py src/pydantic_models --output $env:MY_TOOLSET\REFERENCE\SYSTEM\model-docs
```

**Add new model documentation:**
1. Run generator with specific model filter
2. Update this README with new model entry
3. Update date stamp

---

*Auto-generated documentation from Pydantic model schemas*
